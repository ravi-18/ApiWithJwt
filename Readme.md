Untuk jawaban soal nomor 1 dan 2 ada di link berikut. 
simulasi nomor 1:
http://sqlfiddle.com/#!18/ed91ea/1

simulasi nomor 2: 
https://dotnetfiddle.net/63SbPb 
